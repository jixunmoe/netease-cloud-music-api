document.body.classList.remove("nojs"),document.body.classList.add("js"),$(function(){function e(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function r(){if(window.grecaptcha)null!==i?grecaptcha.reset(i):i=grecaptcha.render("recaptcha",{sitekey:t.data("sitekey")});else{var e=document.createElement("script");e.src="https://www.google.com/recaptcha/api.js?onload=loadCaptcha&render=explicit",document.body.appendChild(e)}}var t=$("body"),n=location.protocol+"//"+location.host+"/",o=["","音乐数据解析失败"],a=(document.getElementById("preview"),new Vue({el:"#app",data:{verified:t.data("verified"),error:"",src_url:"",rate:128e3,url:"",song:{}},methods:{sign:function(e){e.preventDefault(),a.url="";var t=$("#sign",a.$el).serialize(),i=a.src_url;if(!/^\d+$/.test(i)){var c=i.match(/song(?:\?id=|\/)(\d+)/);if(!(c&&c.length>0))return void(a.error="无效的 ID 或无法识别的地址。");i=c[1]}var d=i+"/"+a.rate;$.post("/sign/"+d,t,function(e){return a.verified=e.verified,e.verified?e.errno?void(a.error=o[e.errno]):(a.url=n+d+"/"+e.sign,a.song=e.song,void(a.error="")):(a.error="请先填写验证码!",void r())}).fail(function(){a.error="服务器内部错误。"})},sel:function(e){var r=e.currentTarget;r.setSelectionRange(0,r.value.length)}},created:function(){document.body.classList.add("vue"),this.verified||r()}})),i=null;window.loadCaptcha=r;var c=document.getElementById("copy"),d=new Clipboard(c);c.addEventListener("click",function(e){e.preventDefault()}),d.on("success",function(){alert("复制成功!")}).on("error",function(){var r=e()?"长按":"右键";alert("复制失败，请"+r+"链接然后选择复制！")})});